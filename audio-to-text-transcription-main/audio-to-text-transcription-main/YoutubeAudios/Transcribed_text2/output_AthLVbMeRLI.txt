 In this lecture, we will be looking at another numerical method technique that is we will actually look at two. First we will look at integration, how we can integrate a function. There are several methods for doing that we will look at only one method and you can after that you can look up for other methods. Next we will proceed to see how ordinary differential equation can be solved using numerical techniques using programming. So, first of all let us start with integration. Now, all of you know what integration means given a particular function, in a particular function integration is say I have got a function like this and I want to integrate suppose this function is f x and I want to integrate it within the range a and b. So, we write that as integral a to b of f x. And you also know that this integration actually means the area that is under this curve alright this value is the integration. So, we will look at how we can solve this problem. The simplest a very simple method is a trapezoidal method which we will discuss here. So, you can see that let me go back to this this case. Now, you can see that I can approximate this curve in a very simplistic case using a trapezoid right. So, I have got a trapezoid here let me draw in blue. So, the area under this trapezoid this is way itself. So, the area under this trapezoid is approximating under this trapezoid is approximating the area under the curve. But that is becoming possible here except for this error that is becoming possible here here because the curve was very much not very skewed in that sense. But if the curve were something like this that say it was something like this and I was trying to integrate it between these ranges then if I had fitted a trapezoid here here then the amount of error would be much more because I will be committing errors at these points. I am not considering this I am over considering this points etcetera. So, the error would be more. So, it is not always the case that a simple trapezoid one single trapezoid will solve. But let us start with that and try to understand how we can go ahead with the problem. So, the area under the curve in this particular curve as you can see here this particular curve that has gone through this is a trapezoid under the curve is a trapezoid this part if I assume it to be a trapezoid in that case the integral of f x d x is the area of the trapezoid and we know that the area of a trapezoid is nothing but half the sum of the parallel sides that means, f a plus f b divided by the height. Now, if I look at it these are the parallel sides then the height is this b minus a this this amount. So, this is a known result therefore, I can say if I can approximate a curve by a single trapezoid in this way b minus a times f a f b plus f a by 2 or f a plus f b by 2. But of course, we will see that there can be errors due to this approximation but this is a simple formula which we can quickly compute is very easy to write a program for that you have got a function that will compute the curve. So, you call it for a and call it for b and compute this expression you will get the integral integral. So, here is an example why is this important suppose the vertical distance covered by a rocket from time 8 to 30. So, my timeline is from 8 seconds to 30 second is given by this formula. So, the vertical distance overall total vertical distance is this this is a complicated formula. Now, using single segment trapezoidal rule let us try to find the distance covered. Let us try to find out the distance covered for this. So, we know for 8 and for 30 if I compute this function this was my function. So, for f 8 my function is yielding this value and for f 30 the function is yielding this value. We can compute using you can use your calculator and find it out that you need not do right now. So, you can compute the values at these two points because this is the overall function and next. So, this is the f 8 and f 30. So, what will be my integral my integral will therefore, b 30 minus 8 b minus a f a plus a b by 2. So, that is coming to this value sorry that is coming to 1 1 8 6 8 meter the distance covered is this. But however, the exact value if you computed the exact value if you do a detailed computation will be 1 1 0 6 1 meter. So, there is an error obviously, there is an error because I have approximated the curve using a trapezoid. Now, let us see how great is the error how big is the error. So, we can see that the true error is minus 807 meter right that is quite significant 800 meters and the absolute relative error which is the actual error true value and the computed value and divided by the true value you find that I am getting 7 percent more than 7 percent error how can you better it how can you better it therefore. So, our answer will be we will instead of applying a single fitting in a single trapezoid I can try to fit in more than one trapezoid here like something like this that there is a trapezoid here I fit in one trapezoid here I fit in another trapezoid here and I thereby I can approximate I can minimize my error to some extent. So, here what we are trying to do instead of taking 8 and 30 and fitting in one trapezoid for the whole thing instead of fitting in a one trapezoid for the whole thing what we are trying to do is we are fitting in one trapezoid for 8 to 19 another for 19 to 30 ok. So, now again using the same formula we find then here is 1 19 to 8 to 19 this is the integrand plus the other trapezoid is giving me this. So, I am fitting in two trapezoids now clear. So, if I do that then let us see whether the result is being bettered. So, I compute f 8 at f 30 and f 19 and compute both of these values the areas under the curve here and here and the result is 1 1 2 6 6 meters. Now, how how far is it from the actual now we can see that the true error is now has reduced from 800 7 meters to 205 meters. So, that tells us that if we can extend this procedure and fitting more and smaller but more number of trapezoids my error will come down further still taking q from this idea what is being done is the multiple segment trapezoidal rule therefore, is that we divide into equal segments say here is one trapezoid here is one it is not coming here let us see select on the color say here is one trapezoid here is another trapezoid here is another trapezoid and here is another trapezoid I am getting four trapezoids here and trying to formulate this I can do that in this way. So, the integral is this whole thing which will be some of these trapezoids remember each these lines these lines these this distance is the same. So, I am dividing b minus a by some particular value n and that is my h. So, this is h this is h like that I am going for equidistant points and drawing the trapezoids from there. So, therefore, if I follow this as is shown in this way the trapezoidal rule trapezoidal rule can be written as integral of a from a to b is sum of half f n plus f n plus 1 that is f a plus f b by 2 times the particular distance that is there x o x 1 minus a x 2 minus x 1 usually you do it in the equidistant mode ok. So, now multi segment trapezoidal rule is therefore, and integral r can be broken down this is simple from a to a plus h I can have f x d x a plus h 2 a plus 2 h f x d x plus a plus n minus 2 h 2 a plus n minus 1 h f x d x a plus n minus 1 h 2 b. So, all the segments are being added together applying this I get this formula b by a divided by 2 n because n is coming 2 is coming n times. So, f a plus f b plus 2 into f f a plus h because that is coming twice here once and here once you see here f a plus h will come here f a plus h will come right ok. So, using this let us do the example again the same thing using 2 segment trapezoidal rule we could find that the error is coming down we have already seen that the true value of error is coming down and the absolute latent error has come to 1.853. So, now let us come to c programming straight away how can we encode it using the c program you see here. So, I am reproducing the result here again. So, integral of f x d x between a and b will be h by 2 f a plus 2 f f a plus h plus 2 f a plus 2 h why this 2 is coming because in the first zone f a and f f f a plus h second zone f a plus h plus f a plus 2 h. So, each of these intermediate points are coming twice that is why this 2 and I have got this formula. Now, as a c programmer your task is very simple you see here that I have defined a and i whatever I am asking the user for the necessary inputs how many number number of sub intervals that you want to have the initial limit a you are reading the initial limit b all those things you are reading now the integral computation is done here what is being done h is I am finding out the absolute value of b because b and a b minus a divided by n and I am taking the absolute value of that all right because it could have gone on the other side also. So, now here I am just computing the sum what sum this part what initially x is a plus i h sum sum plus f x. So, each of them next time it is becoming 2 all those things I am adding here. So, here I am in a loop I am doing a plus i h initially i is 1. So, 1 h 2 h like that I am going on doing that and ultimately and I am computing the sum here sum plus f x. Now, note that f x is a separate function that has been kept somewhere here and then ultimately I find the sum sum is these things a plus a this this points. Now, integral is h by 2 this part f a plus f b plus f a plus f b plus twice the sum a plus a h a plus 2 h a plus k h like that that part has been a plus i h has been computed inside this loop and that I add with 2 here and here is my integral. So, that is the trapezoidal rule it is the program is so simple if you understand the concept ok. Next we will move to another very important engineering computation that is needed is solving ordinary differential equations. Quickly let us all of you know what a differential equation is and we will in particular look at Rungi Kutta's 4th order method and here I will show examples that you can also find in this site of University of South Florida numerical methods and I have taken the slides from them with the permission now you see how to write an ordinary differential equation. Now, an ordinary differential equation you know is dy dx f x y ok. Now, dy dx so how do I write it? I write it as suppose this is something given dy dx plus 2 y is 1.3 into it is the power minus x and what is this part? This is the initial condition ok. Now, this can be rewritten as by just changing the direction because I have to bring it to this form dy dx is 1.3 E minus x minus 2 y. So, in this case we will assume that our f x y f x y that is the dy dx is 1.3 this thing into e to the power minus x minus 2 y this is our function differential equation that we will have to solve. So, for dy dx the Rungi Kutta 4th order method I am not going into the derivation of it for positive of time and you can always look at look into this at any website or you can look at any numerical method textbook. So, the Rungi Kutta 4th order method takes 4 terms and this is the expression given this dy dx my task of solving a differential equation is to find the particular y right. So, what we are trying to do y i plus 1 is y i some particular y i plus 1 by 6 followed by a term and what is that term K 1 plus 2 K 2 plus 2 K 3 plus K 4 this whole thing multiplied by H. H is the again the sampling gap that is the distance between the individual points that we look at. Now, what is K 1? So, K 1 is nothing but when I am taking for y i f x psi y i that particular function is K 1 what is K 2 K 2 is f of. So, suppose there is a curve now I have been given the slope I do not know the curve. So, I have to if I know the curve again the same problem if I know the curve then I can find out the value of any particular y i plus 1 given any y i. Now, given any y i I am trying to guess the curve right I am trying to solve the curve. So, x i was here x i plus half h I am taking whatever was my h I am taking half of h and what is the y part of this function y i plus half of K 1 h. So, because K 1 was if I K 1 was the function that was giving y given an x that was giving y for an x. So, I am taking this what is K 3 K 3 is again this part is same x i plus half h, but this part is now becoming much more predictive. So, it is half of K 2 h half of K 2 that means, whatever has been computed here times h and K 4 is x i plus h the last one is x i plus h because I am trying to find solve the equation within this zone h. So, x i plus h I start with x i and this is x i plus h all right times K 3 h here there is no half. Now, this derivation you can look at, but ultimately I multiply it with 1 by 6. So, given this Runga Kutta formula, let us quickly look at an example that will be a very nice thing to look at. Suppose a ball is at 1200 Kelvin and is allowed to cool down in air in an ambient temperature of 300 Kelvin. So, the air the ball was heated and cooling down assuming that the heat is lost only due to radiation the differential equation for the temperature is given here this one all right. Where theta 0 we know initial condition is 1200 Kelvin, find the temperature at T 4 H T. So, what is my x i and so now, if I assume a step size of 240 I want to find out the temperature at 480. So, suppose it was a particular temperature after 480 seconds. So, here is time it was at 1200 and I have got some radiation formula using which it is coming down. So, I want to find out what would the temperature be at 480 seconds, 480 seconds from the starting point where it was 1200 degree Kelvin. I want to find out this temperature that is the y i I want to find out, find out given the slope of this differential equation. So, assuming a step size of H to be 240 half of this if I take half of this 240 then d theta dT you can compute that here if you compute the dT that dT that dT is here. So, my formula will be theta i and theta i k 1 plus 2 k 2 plus 2 k 3 plus k 4 divided by 6 times H that is the Rungi Kutta formula R k formula. So, that is what I want to find out. So, now step 1 you see I am not going into all these calculations, but I am finding out the value of k 1 all right. I am finding out the value of k 2 using this value of k 1 k 1 is being used here and I find out the value of k 2 again the value of k 2 is being used here I find out the value of k 3 and k 3 is being used here I find out the value of k 4 I find out those values all right manually manually I am doing that now. So, the solution therefore, the approach then theta 0 was 1200 initial condition and here I put in the values of this times H H was 240. So, I have taken it at the midpoint. So, I find that the temperature sorry the temperature that would be would be 675.65 that is the approximate temperature at 240 all right. So, this will be the value at 240. Next I have to find out at 480. So, what would I do? Step 2 I have taken I have taken at half point I found out now my initial value theta 0 is changing now I again do the same thing find out k 1 find out k 2 find out k 3 find out k 4 now with this initial condition using the same function all right H is again what is what will be H H will be again 240 because I have to find it out at 480 right at 480 in the temperature. So, now I find out that using theta 1 is now 675.65 that is the approximate value that I got earlier and I compute this I find out using the same Rungi Kutta method that this is the approximate temperature at 480 degree at at 480 seconds would be 594.91 degree Kelvin. This is how we apply Rungi Kutta method and very useful. So, the exact solution of the differential equation is 647.57 if I solve it now it was and we got it how much 594.91 and 594.91. So, it was not very far not very far around 50 degree Kelvin that is certainly an approximation. So, now we have understood what is Rungi Kutta method now I want to write a C program for it again you might find the approach to be mathematically very novel maybe intricate you may find some initial difficulty in understanding, but I am sure you will understand it very fast. You will see that the encoding it as a C program is or as a program is really simple. Now, you are learning C you can in future you will be using MATLAB and other things you will be able to solve it very easily. I am showing you the C solution here on this side I have kept what we learnt till now right. Y i plus 1 that means, in our case the temperature at 480 degree is temperature at 240 degree plus this and k 1 is f x y k 2 is f x i this one f x i plus half h plus y i plus half k 1 h etcetera etcetera etcetera. So, now let us look at the program we have got the math function everything ready. Now, this function somehow this function has to be written now this function is here it is being shown as a very simple function it can be any function the differential equation function the earlier function that we have shown the log function that you have to write. So, here is an example of a simple function x minus y by x plus y just for illustrative function whatever is your differential I mean sorry the divide x given that will come in this function. So, now you see here I read how many times and the h value x 0 x 1 value all these things I read. Now, the key thing comes here this is the implementation of the Runga Kutta method. So, very simple you see I am computing k 1 k 1 is f x 0 y 0. So, I am coming to this function computing x 0 y 0 then I am going back computing k 2 for x 0 plus h by 2 h has been read here scan F h h has been read this h has been read then y 0 plus m 1 I am sorry here it should be k 1 k 1 and this should be k 2 all these m c read as k this is k 3 this is k 3 this is k 3 this is k 2 times h. So, actually we are computing this thing straight away I am computing all these and then y is assigned y plus k h sorry this whole thing is k h here this will also be k. So, it will be this statement will be y will be y plus k h y plus k h right and x x plus h I am implementing x and going on all right I am doing it for two intervals still I come over here. So, I ultimately come to this print F and I print the value of y for a particular x that is the Runga Kutta. So, this this is straight away amenable to some c program and for each of these F's you are calling you are calling the function every time all right. So, this is the Runga Kutta method for solving a differential equation. So, I would encourage you to look at other methods of integration like Simpsons 1 third rule is a very popular method and differentially equation Runga Kutta this is known as Runga Kutta 4th order method because we are taking 4 terms here there are even but this works very well for most of the engineering problems. So, I will encourage you to write programs on this and later on henceforth we will move to another interesting aspect that is known as recursion a new style of programming which will take up in the next lecture. Thank you.